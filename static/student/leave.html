<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ç”Ÿåœ¨çº¿è¯·å‡ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .header {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
            overflow: hidden;
        }
        
        .nav-tabs {
            display: flex;
            list-style: none;
        }
        
        .nav-tabs li {
            flex: 1;
            text-align: center;
            transition: all 0.3s;
        }
        
        .nav-tabs li a {
            display: block;
            padding: 18px 0;
            text-decoration: none;
            color: #333;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .nav-tabs li.active a {
            color: #1E9FFF;
            border-bottom: 3px solid #1E9FFF;
        }
        
        .nav-tabs li:first-child a {
            background-color: #1E9FFF;
            color: #fff;
        }
        
        .nav-tabs li:hover:not(:first-child) {
            background-color: #f8f9fa;
        }
        
        /* é¡µé¢å†…å®¹åŒºåŸŸ */
        .page-content {
            display: none;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 25px;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .page-content.active {
            display: block;
        }
        
        /* é¦–é¡µæ ·å¼ */
        .welcome-section {
            text-align: center;
            padding: 50px 20px;
        }
        
        .welcome-title {
            font-size: 32px;
            color: #1E9FFF;
            margin-bottom: 20px;
        }
        
        .welcome-text {
            font-size: 16px;
            color: #666;
            max-width: 600px;
            margin: 0 auto 30px;
        }
        
        .quick-actions {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 40px;
        }
        
        .action-card {
            background: linear-gradient(135deg, #1E9FFF 0%, #0d8ae0 100%);
            border-radius: 12px;
            padding: 30px 20px;
            width: 220px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            box-shadow: 0 5px 15px rgba(30, 159, 255, 0.3);
        }
        
        .action-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 25px rgba(30, 159, 255, 0.4);
        }
        
        .action-icon {
            font-size: 42px;
            margin-bottom: 15px;
        }
        
        .action-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        /* è¡¨å•åŒºåŸŸ */
        .form-section {
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid #eee;
        }
        
        .section-title {
            font-size: 20px;
            color: #333;
            margin-bottom: 20px;
            padding-left: 12px;
            border-left: 4px solid #1E9FFF;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 20px;
            gap: 25px;
        }
        
        .form-group {
            flex: 1;
            min-width: 250px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
        }
        
        .required::after {
            content: "*";
            color: red;
            margin-left: 4px;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 15px;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            border-color: #1E9FFF;
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 159, 255, 0.2);
        }
        
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 8px;
        }
        
        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .radio-item input[type="radio"] {
            accent-color: #1E9FFF;
        }
        
        .hidden {
            display: none;
        }
        
        /* æ“ä½œæŒ‰é’®åŒºåŸŸ */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
        }
        
        .submit-btn {
            background-color: #c2c2c2;
            color: #fff;
            border: none;
            padding: 14px 45px;
            border-radius: 6px;
            cursor: not-allowed;
            transition: all 0.3s;
            font-size: 16px;
            font-weight: 500;
        }
        
        .submit-btn.enabled {
            background-color: #1E9FFF;
            cursor: pointer;
        }
        
        .submit-btn.enabled:hover {
            background-color: #0d8ae0;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(30, 159, 255, 0.3);
        }
        
        .cancel-btn {
            background-color: #fff;
            color: #333;
            border: 1px solid #e6e6e6;
            padding: 14px 45px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            font-weight: 500;
        }
        
        .cancel-btn:hover {
            background-color: #f2f2f2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* è¯·å‡è®°å½•æ ·å¼ */
        .record-list {
            margin-top: 20px;
        }
        
        .record-item {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 18px;
            border-left: 5px solid #1E9FFF;
            transition: all 0.3s;
        }
        
        .record-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .record-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        
        .record-type {
            font-weight: bold;
            color: #1E9FFF;
            font-size: 18px;
        }
        
        .record-time {
            color: #666;
            font-size: 15px;
        }
        
        .record-status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }
        
        .status-approved {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        .status-pending {
            background-color: #fff3e0;
            color: #ef6c00;
        }
        
        .status-rejected {
            background-color: #ffebee;
            color: #c62828;
        }
        
        /* é€šçŸ¥æ ·å¼ */
        .notification-list {
            margin-top: 20px;
        }
        
        .notification-item {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 18px;
            border-left: 5px solid #1E9FFF;
            transition: all 0.3s;
        }
        
        .notification-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .notification-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        
        .notification-title {
            font-weight: bold;
            color: #333;
            font-size: 18px;
        }
        
        .notification-time {
            color: #666;
            font-size: 14px;
        }
        
        .notification-content {
            color: #666;
            margin-bottom: 12px;
            line-height: 1.6;
        }
        
        .notification-reply {
            background-color: #e3f2fd;
            padding: 12px 15px;
            border-radius: 8px;
            margin-top: 12px;
            border-left: 3px solid #1E9FFF;
        }
        
        /* å¸¸è§é—®é¢˜åŒºåŸŸ */
        .faq-section {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 25px;
            margin-top: 25px;
        }
        
        .faq-title {
            font-size: 18px;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .faq-content {
            color: #666;
            line-height: 1.7;
        }
        
        .faq-content p {
            margin-bottom: 10px;
        }
        
        /* é”™è¯¯æç¤º */
        .error-msg {
            color: red;
            font-size: 13px;
            margin-top: 6px;
            display: none;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 18px;
            }
            
            .form-group {
                min-width: 100%;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .quick-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .record-header, .notification-header {
                flex-direction: column;
                gap: 8px;
            }
            
            .action-card {
                width: 100%;
                max-width: 280px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <div class="header">
            <ul class="nav-tabs">
                <li class="active"><a data-page="home">é¦–é¡µ</a></li>
                <li><a data-page="apply">å­¦ç”Ÿè¯·å‡ç”³è¯·</a></li>
                <li><a data-page="records">æŸ¥çœ‹è¯·å‡è®°å½•</a></li>
                <li><a data-page="notifications">é€šçŸ¥</a></li>
            </ul>
        </div>
        
        <!-- é¦–é¡µå†…å®¹ -->
        <div id="home" class="page-content active">
            <div class="welcome-section">
                <h1 class="welcome-title">å­¦ç”Ÿåœ¨çº¿è¯·å‡ç³»ç»Ÿ</h1>
                <p class="welcome-text">æ¬¢è¿ä½¿ç”¨å­¦ç”Ÿåœ¨çº¿è¯·å‡ç³»ç»Ÿï¼Œæ‚¨å¯ä»¥å¿«é€Ÿæäº¤è¯·å‡ç”³è¯·ã€æŸ¥çœ‹è¯·å‡è®°å½•å’Œæ¥æ”¶é€šçŸ¥ã€‚</p>
                
                <div class="quick-actions">
                    <div class="action-card" data-page="apply">
                        <div class="action-icon">ğŸ“</div>
                        <div class="action-title">è¯·å‡ç”³è¯·</div>
                        <p>æäº¤æ–°çš„è¯·å‡ç”³è¯·</p>
                    </div>
                    <div class="action-card" data-page="records">
                        <div class="action-icon">ğŸ“‹</div>
                        <div class="action-title">è¯·å‡è®°å½•</div>
                        <p>æŸ¥çœ‹å†å²è¯·å‡è®°å½•</p>
                    </div>
                    <div class="action-card" data-page="notifications">
                        <div class="action-icon">ğŸ””</div>
                        <div class="action-title">é€šçŸ¥</div>
                        <p>æŸ¥çœ‹æœ€æ–°é€šçŸ¥</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è¯·å‡ç”³è¯·é¡µé¢ -->
        <div id="apply" class="page-content">
            <!-- è¡¨å•åŒºåŸŸ -->
            <div class="form-container">
                <!-- å»å‘ä¿¡æ¯æ¨¡å— -->
                <div class="form-section">
                    <h3 class="section-title">å»å‘ä¿¡æ¯</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">æ˜¯å¦å‡ºæ ¡</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="leaveSchool" value="yes" id="leaveYes">
                                    <label for="leaveYes">æ˜¯</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="leaveSchool" value="no" id="leaveNo">
                                    <label for="leaveNo">å¦</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row hidden" id="leaveCitySection">
                        <div class="form-group">
                            <label class="form-label">æ˜¯å¦ç¦»å¼€å¸‚å†…</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="leaveCity" value="yes" id="cityYes">
                                    <label for="cityYes">æ˜¯</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="leaveCity" value="no" id="cityNo">
                                    <label for="cityNo">å¦</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row hidden" id="destinationSection">
                        <div class="form-group">
                            <label class="form-label">å»å‘å‡ºæ ¡</label>
                            <input type="text" class="form-control" placeholder="è¯·è¾“å…¥" id="destination">
                        </div>
                    </div>
                    
                    <div class="form-row hidden" id="addressSection">
                        <div class="form-group">
                            <label class="form-label">è¯¦ç»†åœ°å€</label>
                            <input type="text" class="form-control" placeholder="è¯·è¾“å…¥" id="address">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label required">ç´§æ€¥è”ç³»äººç”µè¯</label>
                            <input type="text" class="form-control" placeholder="è¯·è¾“å…¥" id="emergencyContact">
                            <div class="error-msg" id="emergencyContactError">è¯·å¡«å†™ç´§æ€¥è”ç³»äººç”µè¯</div>
                        </div>
                    </div>
                </div>
                
                <!-- è¯·å‡ä¿¡æ¯æ¨¡å— -->
                <div class="form-section">
                    <h3 class="section-title">è¯·å‡ä¿¡æ¯</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label required">è¯·å‡ç±»å‹</label>
                            <select class="form-control" id="leaveType">
                                <option value="">è¯·é€‰æ‹©</option>
                                <option value="äº‹å‡">äº‹å‡</option>
                                <option value="ç—…å‡">ç—…å‡</option>
                                <option value="å©šå‡">å©šå‡</option>
                                <option value="ä¸§å‡">ä¸§å‡</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                            <div class="error-msg" id="leaveTypeError">è¯·é€‰æ‹©è¯·å‡ç±»å‹</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label required">è¯·å‡æ€§è´¨</label>
                            <select class="form-control" id="leaveNature">
                                <option value="">è¯·é€‰æ‹©</option>
                                <option value="å…¬å‡">å…¬å‡</option>
                                <option value="ç§å‡">ç§å‡</option>
                            </select>
                            <div class="error-msg" id="leaveNatureError">è¯·é€‰æ‹©è¯·å‡æ€§è´¨</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label required">è¯·å‡å¤©æ•°</label>
                            <input type="text" class="form-control" placeholder="è¯·è¾“å…¥" id="leaveDays">
                            <div class="error-msg" id="leaveDaysError">è¯·å¡«å†™è¯·å‡å¤©æ•°</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label required">æ‰‹æœºå·</label>
                            <input type="text" class="form-control" placeholder="è¯·è¾“å…¥" id="phone">
                            <div class="error-msg" id="phoneError">è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·æ ¼å¼</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label required">è¯·å‡å¼€å§‹æ—¶é—´</label>
                            <input type="datetime-local" class="form-control" id="startTime">
                            <div class="error-msg" id="startTimeError">è¯·é€‰æ‹©å¼€å§‹æ—¶é—´</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label required">è¯·å‡ç»“æŸæ—¶é—´</label>
                            <input type="datetime-local" class="form-control" id="endTime">
                            <div class="error-msg" id="endTimeError">è¯·é€‰æ‹©ç»“æŸæ—¶é—´</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label required">è¯·å‡äº‹ç”±</label>
                            <textarea class="form-control" placeholder="è¯·è¾“å…¥è¯·å‡äº‹ç”±" id="leaveReason"></textarea>
                            <div class="error-msg" id="leaveReasonError">è¯·å¡«å†™è¯·å‡äº‹ç”±</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label required">ä»»è¯¾è€å¸ˆ</label>
                            <select class="form-control" id="teacher">
                                <option value="">è¯·é€‰æ‹©</option>
                                <option value="å¼ è€å¸ˆ">å¼ è€å¸ˆ</option>
                                <option value="æè€å¸ˆ">æè€å¸ˆ</option>
                                <option value="ç‹è€å¸ˆ">ç‹è€å¸ˆ</option>
                                <option value="èµµè€å¸ˆ">èµµè€å¸ˆ</option>
                            </select>
                            <div class="error-msg" id="teacherError">è¯·é€‰æ‹©ä»»è¯¾è€å¸ˆ</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
            <div class="action-buttons">
                <button class="submit-btn" id="submitBtn" disabled>æäº¤</button>
                <button class="cancel-btn" id="cancelBtn">å–æ¶ˆ</button>
            </div>
        </div>
        
        <!-- è¯·å‡è®°å½•é¡µé¢ -->
        <div id="records" class="page-content">
            <h3 class="section-title">è¯·å‡è®°å½•</h3>
            
            <div class="record-list" id="recordList">
                <!-- è®°å½•å°†é€šè¿‡APIåŠ¨æ€åŠ è½½ -->
            </div>
        </div>
        
        <!-- é€šçŸ¥é¡µé¢ -->
        <div id="notifications" class="page-content">
            <h3 class="section-title">é€šçŸ¥</h3>
            
            <div class="notification-list" id="notificationList">
                <!-- é€šçŸ¥å°†é€šè¿‡APIåŠ¨æ€åŠ è½½ -->
            </div>
        </div>
        
        <!-- å¸¸è§é—®é¢˜åŒºåŸŸ -->
        <div class="faq-section">
            <div class="faq-title">å¸¸è§é—®é¢˜</div>
            <div class="faq-content">
                <p>1. ç—…å‡éœ€æä¾›åŒ»é™¢å¼€å…·çš„è¯æ˜ï¼Œäº‹å‡éœ€æä¾›ç›¸å…³è¯æ˜ææ–™ã€‚</p>
                <p>2. è¿ç»­è¯·å‡è¶…è¿‡3å¤©éœ€æå‰å‘è¾…å¯¼å‘˜æŠ¥å¤‡ã€‚</p>
                <p>3. ç´§æ€¥æƒ…å†µä¸‹å¯å…ˆç”µè¯è”ç³»è¾…å¯¼å‘˜ï¼Œäº‹åè¡¥åŠè¯·å‡æ‰‹ç»­ã€‚</p>
                <p>4. è¯·å‡æœŸé—´éœ€ä¿æŒæ‰‹æœºç•…é€šï¼Œä»¥ä¾¿å­¦æ ¡è”ç³»ã€‚</p>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿåç«¯API
        const API_BASE_URL = 'https://api.example.com'; // å®é™…é¡¹ç›®ä¸­æ›¿æ¢ä¸ºçœŸå®APIåœ°å€
        
        // æ¨¡æ‹ŸAPIå‡½æ•°
        const api = {
            // æäº¤è¯·å‡ç”³è¯·
            async submitLeaveApplication(data) {
                // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // æ¨¡æ‹ŸæˆåŠŸå“åº”
                return {
                    success: true,
                    message: 'è¯·å‡ç”³è¯·æäº¤æˆåŠŸ',
                    data: {
                        id: Math.floor(Math.random() * 1000) + 1,
                        ...data,
                        status: 'pending',
                        createdAt: new Date().toISOString()
                    }
                };
            },
            
            // è·å–è¯·å‡è®°å½•
            async getLeaveRecords() {
                // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 800));
                
                // æ¨¡æ‹Ÿæ•°æ®
                return {
                    success: true,
                    data: [
                        {
                            id: 1,
                            type: 'äº‹å‡',
                            startTime: '2025-10-09T08:00:00',
                            endTime: '2025-10-09T18:00:00',
                            days: 0.42,
                            status: 'pending'
                        },
                        {
                            id: 2,
                            type: 'ç—…å‡',
                            startTime: '2025-10-08T08:00:00',
                            endTime: '2025-10-08T18:00:00',
                            days: 0.42,
                            status: 'approved'
                        },
                        {
                            id: 3,
                            type: 'äº‹å‡',
                            startTime: '2025-10-07T08:00:00',
                            endTime: '2025-10-07T18:00:00',
                            days: 0.42,
                            status: 'approved'
                        },
                        {
                            id: 4,
                            type: 'äº‹å‡',
                            startTime: '2025-10-06T08:00:00',
                            endTime: '2025-10-06T18:00:00',
                            days: 0.42,
                            status: 'approved'
                        }
                    ]
                };
            },
            
            // è·å–é€šçŸ¥
            async getNotifications() {
                // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 800));
                
                // æ¨¡æ‹Ÿæ•°æ®
                return {
                    success: true,
                    data: [
                        {
                            id: 1,
                            title: 'æ•™å¸ˆå›å¤ï¼šè¯·å‡ç”³è¯·é€šè¿‡',
                            content: 'ä½ å‘ç»™æˆ‘çš„ä¿¡ä»¶å·²æ”¶åˆ°ã€‚è¯·æŒ‰æ—¶è¿”æ ¡ï¼Œæ³¨æ„å®‰å…¨ã€‚',
                            reply: 'è¯·å‡ç”³è¯·å·²æ‰¹å‡†ï¼Œè¯·æŒ‰æ—¶è¿”æ ¡ã€‚',
                            time: 'æ˜¨å¤© 12:15'
                        },
                        {
                            id: 2,
                            title: 'æ•™å¸ˆå›å¤ï¼šè¯·å‡ç”³è¯·é€šè¿‡',
                            content: 'ä½ å‘ç»™æˆ‘çš„ä¿¡ä»¶å·²æ”¶åˆ°ã€‚è¯·æŒ‰æ—¶è¿”æ ¡ï¼Œæ³¨æ„å®‰å…¨ã€‚',
                            reply: 'è¯·å‡ç”³è¯·å·²æ‰¹å‡†ï¼Œè¯·æŒ‰æ—¶è¿”æ ¡ã€‚',
                            time: 'æ˜¨å¤© 12:15'
                        },
                        {
                            id: 3,
                            title: 'æ•™å¸ˆå›å¤ï¼šè¯·å‡ç”³è¯·é€šè¿‡',
                            content: 'ä½ å‘ç»™æˆ‘çš„ä¿¡ä»¶å·²æ”¶åˆ°ã€‚è¯·æŒ‰æ—¶è¿”æ ¡ï¼Œæ³¨æ„å®‰å…¨ã€‚',
                            reply: 'è¯·å‡ç”³è¯·å·²æ‰¹å‡†ï¼Œè¯·æŒ‰æ—¶è¿”æ ¡ã€‚',
                            time: 'æ˜¨å¤© 12:15'
                        },
                        {
                            id: 4,
                            title: 'æ•™å¸ˆå›å¤ï¼šè¯·å‡ç”³è¯·é€šè¿‡',
                            content: 'ä½ å‘ç»™æˆ‘çš„ä¿¡ä»¶å·²æ”¶åˆ°ã€‚è¯·æŒ‰æ—¶è¿”æ ¡ï¼Œæ³¨æ„å®‰å…¨ã€‚',
                            reply: 'è¯·å‡ç”³è¯·å·²æ‰¹å‡†ï¼Œè¯·æŒ‰æ—¶è¿”æ ¡ã€‚',
                            time: 'æ˜¨å¤© 12:15'
                        }
                    ]
                };
            }
        };

        document.addEventListener('DOMContentLoaded', function() {
            // é¡µé¢åˆ‡æ¢åŠŸèƒ½
            const navLinks = document.querySelectorAll('.nav-tabs a, .action-card');
            const pages = document.querySelectorAll('.page-content');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    const targetPage = this.getAttribute('data-page');
                    
                    // æ›´æ–°å¯¼èˆªçŠ¶æ€
                    document.querySelectorAll('.nav-tabs li').forEach(li => {
                        li.classList.remove('active');
                    });
                    
                    if (this.parentElement.classList.contains('nav-tabs')) {
                        this.parentElement.classList.add('active');
                    } else {
                        // å¦‚æœæ˜¯å¿«é€Ÿæ“ä½œå¡ç‰‡ï¼Œæ‰¾åˆ°å¯¹åº”çš„å¯¼èˆªé¡¹
                        const navItem = document.querySelector(`.nav-tabs a[data-page="${targetPage}"]`).parentElement;
                        if (navItem) {
                            navItem.classList.add('active');
                        }
                    }
                    
                    // æ˜¾ç¤ºç›®æ ‡é¡µé¢
                    pages.forEach(page => {
                        page.classList.remove('active');
                        if (page.id === targetPage) {
                            page.classList.add('active');
                            
                            // åŠ è½½å¯¹åº”é¡µé¢çš„æ•°æ®
                            if (targetPage === 'records') {
                                loadLeaveRecords();
                            } else if (targetPage === 'notifications') {
                                loadNotifications();
                            }
                        }
                    });
                });
            });
            
            // è¯·å‡ç”³è¯·é¡µé¢çš„åŠŸèƒ½
            // æ˜¯å¦å‡ºæ ¡å•é€‰æŒ‰é’®è”åŠ¨
            const leaveSchoolRadios = document.querySelectorAll('input[name="leaveSchool"]');
            const leaveCitySection = document.getElementById('leaveCitySection');
            const destinationSection = document.getElementById('destinationSection');
            const addressSection = document.getElementById('addressSection');
            
            leaveSchoolRadios.forEach(function(radio) {
                radio.addEventListener('change', function() {
                    if (this.value === 'yes') {
                        leaveCitySection.classList.remove('hidden');
                        destinationSection.classList.remove('hidden');
                    } else {
                        leaveCitySection.classList.add('hidden');
                        destinationSection.classList.add('hidden');
                        addressSection.classList.add('hidden');
                        
                        // æ¸…ç©ºç›¸å…³å­—æ®µ
                        document.querySelectorAll('input[name="leaveCity"]').forEach(function(r) {
                            r.checked = false;
                        });
                        document.querySelector('#destinationSection input').value = '';
                        document.querySelector('#addressSection input').value = '';
                    }
                });
            });
            
            // æ˜¯å¦ç¦»å¼€å¸‚å†…å•é€‰æŒ‰é’®è”åŠ¨
            const leaveCityRadios = document.querySelectorAll('input[name="leaveCity"]');
            
            leaveCityRadios.forEach(function(radio) {
                radio.addEventListener('change', function() {
                    if (this.value === 'yes') {
                        addressSection.classList.remove('hidden');
                    } else {
                        addressSection.classList.add('hidden');
                        document.querySelector('#addressSection input').value = '';
                    }
                });
            });
            
            // è¡¨å•éªŒè¯
            const requiredFields = [
                'emergencyContact', 'leaveType', 'leaveNature', 'leaveDays', 
                'startTime', 'endTime', 'leaveReason', 'phone', 'teacher'
            ];
            
            const submitBtn = document.getElementById('submitBtn');
            
            // ç›‘å¬è¡¨å•å­—æ®µå˜åŒ–
            requiredFields.forEach(function(fieldId) {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('input', validateForm);
                    field.addEventListener('change', validateForm);
                }
            });
            
            // éªŒè¯è¡¨å•
            function validateForm() {
                let isValid = true;
                
                // éªŒè¯å¿…å¡«å­—æ®µ
                requiredFields.forEach(function(fieldId) {
                    const field = document.getElementById(fieldId);
                    const errorElement = document.getElementById(fieldId + 'Error');
                    
                    if (!field.value.trim()) {
                        isValid = false;
                        if (errorElement) {
                            errorElement.style.display = 'block';
                        }
                    } else {
                        if (errorElement) {
                            errorElement.style.display = 'none';
                        }
                    }
                });
                
                // éªŒè¯æ‰‹æœºå·æ ¼å¼
                const phone = document.getElementById('phone').value;
                const phoneError = document.getElementById('phoneError');
                if (phone && !/^1[3-9]\d{9}$/.test(phone)) {
                    isValid = false;
                    phoneError.style.display = 'block';
                } else if (phone) {
                    phoneError.style.display = 'none';
                }
                
                // éªŒè¯æ—¶é—´
                const startTime = document.getElementById('startTime').value;
                const endTime = document.getElementById('endTime').value;
                
                if (startTime && endTime) {
                    if (new Date(endTime) <= new Date(startTime)) {
                        isValid = false;
                        // è¿™é‡Œå¯ä»¥æ·»åŠ æ—¶é—´é”™è¯¯æç¤º
                    }
                }
                
                // æ›´æ–°æäº¤æŒ‰é’®çŠ¶æ€
                if (isValid) {
                    submitBtn.classList.add('enabled');
                    submitBtn.disabled = false;
                } else {
                    submitBtn.classList.remove('enabled');
                    submitBtn.disabled = true;
                }
            }
            
            // æäº¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            submitBtn.addEventListener('click', function() {
                if (!this.disabled) {
                    submitLeaveApplication();
                }
            });
            
            // æäº¤è¯·å‡ç”³è¯·
            async function submitLeaveApplication() {
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                const originalText = submitBtn.textContent;
                submitBtn.innerHTML = '<span class="loading"></span>æäº¤ä¸­...';
                submitBtn.disabled = true;
                
                try {
                    // æ”¶é›†è¡¨å•æ•°æ®
                    const formData = {
                        leaveSchool: document.querySelector('input[name="leaveSchool"]:checked')?.value,
                        leaveCity: document.querySelector('input[name="leaveCity"]:checked')?.value,
                        destination: document.getElementById('destination').value,
                        address: document.getElementById('address').value,
                        emergencyContact: document.getElementById('emergencyContact').value,
                        leaveType: document.getElementById('leaveType').value,
                        leaveNature: document.getElementById('leaveNature').value,
                        leaveDays: document.getElementById('leaveDays').value,
                        startTime: document.getElementById('startTime').value,
                        endTime: document.getElementById('endTime').value,
                        leaveReason: document.getElementById('leaveReason').value,
                        phone: document.getElementById('phone').value,
                        teacher: document.getElementById('teacher').value
                    };
                    
                    // è°ƒç”¨API
                    const result = await api.submitLeaveApplication(formData);
                    
                    if (result.success) {
                        alert('è¯·å‡ç”³è¯·æäº¤æˆåŠŸï¼Œå¯å‰å¾€"æŸ¥çœ‹è¯·å‡è®°å½•"é¡µé¢æŸ¥çœ‹è¿›åº¦');
                        
                        // é‡ç½®è¡¨å•
                        resetForm();
                    } else {
                        alert('æäº¤å¤±è´¥: ' + result.message);
                    }
                } catch (error) {
                    console.error('æäº¤è¯·å‡ç”³è¯·æ—¶å‡ºé”™:', error);
                    alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
                } finally {
                    // é‡ç½®æŒ‰é’®çŠ¶æ€
                    submitBtn.textContent = originalText;
                    submitBtn.classList.remove('enabled');
                    submitBtn.disabled = true;
                }
            }
            
            // é‡ç½®è¡¨å•
            function resetForm() {
                document.querySelectorAll('input, textarea, select').forEach(function(element) {
                    if (element.type !== 'radio' && element.type !== 'checkbox') {
                        element.value = '';
                    } else {
                        element.checked = false;
                    }
                });
                
                // éšè—åŠ¨æ€æ˜¾ç¤ºçš„åŒºåŸŸ
                leaveCitySection.classList.add('hidden');
                destinationSection.classList.add('hidden');
                addressSection.classList.add('hidden');
                
                // éšè—æ‰€æœ‰é”™è¯¯æç¤º
                document.querySelectorAll('.error-msg').forEach(function(error) {
                    error.style.display = 'none';
                });
            }
            
            // å–æ¶ˆæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.getElementById('cancelBtn').addEventListener('click', resetForm);
            
            // åŠ è½½è¯·å‡è®°å½•
            async function loadLeaveRecords() {
                const recordList = document.getElementById('recordList');
                recordList.innerHTML = '<p>åŠ è½½ä¸­...</p>';
                
                try {
                    const result = await api.getLeaveRecords();
                    
                    if (result.success) {
                        if (result.data.length === 0) {
                            recordList.innerHTML = '<p>æš‚æ— è¯·å‡è®°å½•</p>';
                            return;
                        }
                        
                        recordList.innerHTML = '';
                        result.data.forEach(record => {
                            const startTime = new Date(record.startTime).toLocaleString();
                            const endTime = new Date(record.endTime).toLocaleString();
                            const statusClass = `status-${record.status}`;
                            const statusText = {
                                'pending': 'æœªå®¡æ‰¹',
                                'approved': 'å·²æ‰¹å‡†',
                                'rejected': 'å·²æ‹’ç»'
                            }[record.status] || record.status;
                            
                            const recordItem = document.createElement('div');
                            recordItem.className = 'record-item';
                            recordItem.innerHTML = `
                                <div class="record-header">
                                    <div class="record-type">${record.type}</div>
                                    <div class="record-time">${startTime} è‡³ ${endTime} / å…±${record.days}å¤©</div>
                                </div>
                                <div class="record-status ${statusClass}">${statusText}</div>
                            `;
                            recordList.appendChild(recordItem);
                        });
                    } else {
                        recordList.innerHTML = '<p>åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</p>';
                    }
                } catch (error) {
                    console.error('åŠ è½½è¯·å‡è®°å½•æ—¶å‡ºé”™:', error);
                    recordList.innerHTML = '<p>ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•</p>';
                }
            }
            
            // åŠ è½½é€šçŸ¥
            async function loadNotifications() {
                const notificationList = document.getElementById('notificationList');
                notificationList.innerHTML = '<p>åŠ è½½ä¸­...</p>';
                
                try {
                    const result = await api.getNotifications();
                    
                    if (result.success) {
                        if (result.data.length === 0) {
                            notificationList.innerHTML = '<p>æš‚æ— é€šçŸ¥</p>';
                            return;
                        }
                        
                        notificationList.innerHTML = '';
                        result.data.forEach(notification => {
                            const notificationItem = document.createElement('div');
                            notificationItem.className = 'notification-item';
                            notificationItem.innerHTML = `
                                <div class="notification-header">
                                    <div class="notification-title">${notification.title}</div>
                                    <div class="notification-time">${notification.time}</div>
                                </div>
                                <div class="notification-content">${notification.content}</div>
                                <div class="notification-reply">
                                    <strong>æ•™å¸ˆå›å¤ï¼š</strong> ${notification.reply}
                                </div>
                            `;
                            notificationList.appendChild(notificationItem);
                        });
                    } else {
                        notificationList.innerHTML = '<p>åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</p>';
                    }
                } catch (error) {
                    console.error('åŠ è½½é€šçŸ¥æ—¶å‡ºé”™:', error);
                    notificationList.innerHTML = '<p>ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•</p>';
                }
            }
        });
    </script>
</body>
</html>